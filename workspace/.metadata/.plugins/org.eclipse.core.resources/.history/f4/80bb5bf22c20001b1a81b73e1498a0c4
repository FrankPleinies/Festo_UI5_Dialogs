"use strict";

sap.ui.define(["./Base.controller", "../model/formatter", "sap/ui/model/json/JSONModel", "sap/ui/core/Fragment", "sap/ui/core/BusyIndicator"], function (Controller, formatter, JSONModel, Fragment, BusyIndicator) {
  "use strict";

  return Controller.extend("y20_deco_inb_r.controller.MainScreen", {
    currentSelectedTableItemFromFirstSection: undefined,
    formatJson: "&$format=json",
    formatter: formatter,
    isPopupShownArray: undefined,
    isPopupInfoShownArray: undefined,
    whNumber: undefined,
    onInit: function onInit() {
      this.setCurrentLoggedInUser();
      this.getView().addStyleClass(sap.ui.Device.support.touch ? "sapUiSizeCozy" : "sapUiSizeCompact");
      this.checkWhNumberAndWorkstation();
    },
    checkWhNumberAndWorkstation: function checkWhNumberAndWorkstation() {
      var queryString = window.location.search;
      console.log(queryString);
      var urlParams = new URLSearchParams(queryString); // ?product=shirt&color=blue&newuser&size=m

      this.whNumber = urlParams.get('whnumber');
      var workStation = urlParams.get('workstation');

      if (!this.whNumber || !workStation) {
        //change this url later
        var arr = window.location.pathname.split("/");
        arr[arr.length - 2] = "y20_ui5_login";
        var pathName = arr.join("/");
        var search = window.location.search;
        var appLocation = window.location.origin + pathName; //Send all the params to the login application

        location.replace("".concat(appLocation, "?appname=deco&").concat(search.substring(1, search.length)));
      }
    },
    onAfterRendering: function onAfterRendering() {
      this.setFocusOnScanInput();
    },
    onScanSubmit: function onScanSubmit(oEvent) {
      var _this = this;

      oEvent.getSource().setEnabled(false);
      var currentInput = oEvent.getSource();
      var scannedValue = oEvent.getSource().getValue();
      currentInput.setValue();
      var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
      var setInfo = "(Lgnum='".concat(this.whNumber, "',ScanKey='").concat(scannedValue, "')");
      BusyIndicator.show();
      oModel.read("/ScanDocumentEntCollection" + setInfo, {
        useBatch: false,
        urlParameters: {
          "$expand": "ScanDoc_DocHeadNav,ScanDoc_DocItemNav,ScanDoc_NewPackNav,ScanDoc_ProductNav,ScanDoc_PopDocHeadNav"
        },
        success: function success(data) {
          //fix this later
          currentInput.setEnabled(true);
          var isDialogClosed = true;

          try {
            if (data.ScanDoc_PopDocHeadNav.results.length > 0) {
              _this.onOpenDialog();

              isDialogClosed = false;
            }
          } catch (err) {
            console.log(err);
            BusyIndicator.hide();
          }

          _this.createModelsFromData(data);

          isDialogClosed && setTimeout(function () {
            return _this.selectFirstTableRow();
          }, 0);
          BusyIndicator.hide();
        },
        error: function error(err) {
          currentInput.setEnabled(true);
          BusyIndicator.hide();

          _this.handleMessageResponse(err);
        }
      });
    },
    selectFirstTableRow: function selectFirstTableRow() {
      var table = this.byId("uiTable");
      var firstRow = table.getRows()[0];

      if (firstRow && firstRow.getCells()[0].getText()) {
        this.onRowSelectionChangeUiTable(undefined, 0);
        setTimeout(function () {
          return firstRow._setSelected(true);
        }, 0);
      }
    },
    createModelsFromData: function createModelsFromData(data) {
      var _this2 = this;

      var docHeadNav = data.ScanDoc_DocHeadNav;
      var jsonModelDocHeadNav = new JSONModel(docHeadNav);
      this.getView().setModel(jsonModelDocHeadNav, "modelDocHeadNav");
      this.byId("blockLayoutCellFirst").setTitle("SAP IBD : ".concat(+docHeadNav.DocNo)); //this has arr of results

      var docItemNav = data.ScanDoc_DocItemNav;
      var jsonModeldocItemNav = new JSONModel(docItemNav);
      this.getView().setModel(jsonModeldocItemNav, "modelDocItemNav");
      this.isPopupShownArray = [];
      this.isPopupInfoShownArray = [];
      docItemNav.results && docItemNav.results.forEach(function () {
        _this2.isPopupShownArray.push(true);

        _this2.isPopupInfoShownArray.push(true);
      });
      var newPackNav = data.ScanDoc_NewPackNav;
      var jsonModelnewPackNav = new JSONModel(newPackNav);
      this.getView().setModel(jsonModelnewPackNav, "modelNewPackNav");
      var productNav = data.ScanDoc_ProductNav;
      var jsonModelproductNav = new JSONModel(productNav);
      this.getView().setModel(jsonModelproductNav, "modelProductNav");
      var createdHUNav = data.ScanDoc_CreatedHUNav;
      var jsonModelCreatedHUNav = new JSONModel(createdHUNav);
      this.getView().setModel(jsonModelCreatedHUNav, "modelcreatedHUNav"); //this has arr of results

      var popDocHeadNav = data.ScanDoc_PopDocHeadNav;
      var jsonModelproductDocNav = new JSONModel(popDocHeadNav);
      this.getView().setModel(jsonModelproductDocNav, "modelPopDocHeadNav");
      var measureModel = {
        "Weight": {
          "Quan": "",
          "Unit": ""
        },
        "Height": {
          "Quan": "",
          "Unit": ""
        },
        "Width": {
          "Quan": "",
          "Unit": ""
        },
        "Length": {
          "Quan": "",
          "Unit": ""
        },
        "Lgnum": "",
        "DocId": "",
        "ItemId": ""
      };
      this.getView().setModel(new JSONModel(measureModel), "measureModel");
    },
    onExitPressed: function onExitPressed() {
      console.log(1);
    },
    onOpenDialog: function onOpenDialog() {
      var view = this.getView();
      var popupDialog = this.byId("popupDialog");

      if (!popupDialog) {
        Fragment.load({
          id: view.getId(),
          name: "y20_deco_inb_r.view.PopupDialog",
          controller: this
        }).then(function (popupDialog) {
          view.addDependent(popupDialog);
          popupDialog.open();
        });
      } else {
        this.byId("popupDialog").open();
      }
    },
    onConfirmDialog: function onConfirmDialog() {
      var _this3 = this;

      var table = this.byId("uiTablePopup");
      var selectedIndex = table.getSelectedIndex();

      if (selectedIndex !== -1) {
        var dataArr = this.getView().getModel("modelPopDocHeadNav").getData().results;
        var docId = dataArr[selectedIndex].DocId;
        var lgNum = dataArr[selectedIndex].Lgnum;
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
        var setInfo = "(Lgnum='".concat(lgNum, "',DocId=guid'").concat(docId, "')");
        oModel.read("/PopupSelectDocEntCollection" + setInfo, {
          useBatch: false,
          urlParameters: {
            "$expand": "PopDocHead_DocHeadNav,PopDocHead_DocItemNav"
          },
          success: function success(data) {
            var docHeadNav = data.PopDocHead_DocHeadNav;
            var jsonModelDocHeadNav = new JSONModel(docHeadNav);

            _this3.getView().setModel(jsonModelDocHeadNav, "modelDocHeadNav");

            _this3.byId("blockLayoutCellFirst").setTitle("SAP IBD : ".concat(+docHeadNav.DocNo));

            var docItemNav = data.PopDocHead_DocItemNav;
            var jsonModeldocItemNav = new JSONModel(docItemNav);

            _this3.getView().setModel(jsonModeldocItemNav, "modelDocItemNav");

            _this3.refreshModels();

            setTimeout(function () {
              return _this3.selectFirstTableRow();
            }, 0);
          },
          error: function error(err) {
            console.log(err);
          }
        });
      } else {
        sap.m.MessageToast.show("No Item Selected!");
      }

      var popupDialog = this.byId("popupDialog");
      popupDialog.close();
    },
    //  * Select row from section one UI table
    //  * param  {Object} event SAPUI5 Standard UI event
    //  * param  {Number} selectRow Select any row in the table
    //  * return {Void}   
    onRowSelectionChangeUiTable: function onRowSelectionChangeUiTable(event, selectRow, noFocus) {
      var _this4 = this;

      var table = this.byId("uiTable");
      var selectedIndex = -1; //If selectRow is passed use it.

      if (selectRow !== undefined) {
        selectedIndex = selectRow; // If selectFirstRow is passed use 0.
      } else {
        selectedIndex = table.getSelectedIndex();
      }

      if (selectedIndex !== -1) {
        this.currentSelectedTableItemFromFirstSection = selectedIndex;
        var dataArr = this.getView().getModel("modelDocItemNav").getData().results;
        var docId = dataArr[selectedIndex].DocId;
        var lgNum = dataArr[selectedIndex].Lgnum;
        var itemId = dataArr[selectedIndex].ItemId;
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
        var setInfo = "(Lgnum='".concat(lgNum, "',DocId=guid'").concat(docId, "',ItemId=guid'").concat(itemId, "')");
        BusyIndicator.show();
        this.setAvailableTrolleys(setInfo);
        oModel.read("/DocumentItemSet" + setInfo, {
          useBatch: false,
          urlParameters: {
            "$expand": "DocItem_CreatedHUNav,DocItem_NewPackNav,DocItem_ProductNav"
          },
          success: function success(data, resp) {
            BusyIndicator.hide();
            var productNav = data.DocItem_ProductNav;
            var jsonModelproductNav = new JSONModel(productNav);

            _this4.getView().setModel(jsonModelproductNav, "modelProductNav"); //Popup dialogs below
            // if (productNav.IndConf && this.isPopupShownArray[this.currentSelectedTableItemFromFirstSection]) {
            // 	this.isPopupShownArray[this.currentSelectedTableItemFromFirstSection] = false
            // 	this.onOpenWeightDialog()
            // }


            _this4.onInfoPressed(null, true);

            var createdHUNav = data.DocItem_CreatedHUNav;
            var jsonModelCreatedHUNav = new JSONModel(createdHUNav);

            _this4.getView().setModel(jsonModelCreatedHUNav, "modelcreatedHUNav");

            var newPackNav = data.DocItem_NewPackNav;
            var jsonModelnewPackNav = new JSONModel(newPackNav);

            _this4.getView().setModel(jsonModelnewPackNav, "modelNewPackNav");

            _this4.refreshModels();

            sap.m.MessageToast.show("Data Updated!");

            _this4.handleMessageResponse(resp);

            if (!noFocus) {
              setTimeout(function () {
                return _this4.byId("scanPackHUType").focus();
              }, 0);
            }
          },
          error: function error(err) {
            BusyIndicator.hide();

            _this4.handleMessageResponse(err);
          }
        });
      }
    },
    setAvailableTrolleys: function setAvailableTrolleys(setInfo) {
      var _this5 = this;

      var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
      oModel.read("/UserCommandCollection" + setInfo, {
        useBatch: false,
        urlParameters: {
          "$expand": "UserComm_TrolleyNav"
        },
        success: function success(data) {
          var trolleyDataArr = data.UserComm_TrolleyNav;
          var jsonModelTrolleyNav = new JSONModel(trolleyDataArr);

          _this5.getView().setModel(jsonModelTrolleyNav, "modelTrolleyNav");

          _this5.refreshModels();
        },
        error: function error(err) {
          _this5.handleMessageResponse(err);
        }
      });
    },
    onQuanChange: function onQuanChange() {
      var _this6 = this;

      //https://vi20pas.de.festo.net:443/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV/ScanQuantityEntCollection(Lgnum='TMPL',DocId=guid'005056a1-7205-1eda-9cfa-e9838cd25357',ItemId=guid'005056a1-7205-1eda-9cfa-e9838cd29357',ScanQuan=2.345M)?$expand=ScanQuan_NewPackNav
      var selectedIndex = this.currentSelectedTableItemFromFirstSection;

      if (selectedIndex !== undefined) {
        var dataArr = this.getView().getModel("modelDocItemNav").getData().results;
        var docId = dataArr[selectedIndex].DocId;
        var lgNum = dataArr[selectedIndex].Lgnum;
        var itemId = dataArr[selectedIndex].ItemId;
        var quantity = this.byId("stepInputQuan").getValue();
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
        var setInfo = "(Lgnum='".concat(lgNum, "',DocId=guid'").concat(docId, "',ItemId=guid'").concat(itemId, "',ScanQuan=").concat(quantity, "M)");
        oModel.read("/ScanQuantityEntCollection" + setInfo, {
          useBatch: false,
          success: function success(data, resp) {
            _this6.handleMessageResponse(resp);

            var newData = data.ScanQuan * 1;

            _this6.byId("stepInputQuan").setValue(newData); //Check This


            _this6.getView().getModel("modelNewPackNav").getData().Quantity.Quan = newData.toString();

            _this6.refreshModels();
          },
          error: function error(err) {
            _this6.handleMessageResponse(err);
          }
        });
      } else {
        sap.m.MessageToast.show("No Items is Selected!");
      }
    },
    refreshModels: function refreshModels() {
      var models = this.getView().oModels;

      for (var modelName in models) {
        models[modelName].refresh();
      }
    },
    onPrintPressed: function onPrintPressed(oEvent) {
      var _this7 = this;

      var element = oEvent.getSource();
      element.setEnabled(false);
      BusyIndicator.show();
      var selectedIndex = this.currentSelectedTableItemFromFirstSection;
      var context = this;

      if (selectedIndex !== undefined) {
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
        var requestBody = {};
        requestBody = this.getView().getModel("modelNewPackNav").getData();
        requestBody.NewPack_CreatedHUNav = this.getView().getModel("modelcreatedHUNav").getData();
        requestBody.NewPack_ProductNav = this.getView().getModel("modelProductNav").getData();

        if (requestBody.Quantity.Quan !== undefined) {
          requestBody.Quantity.Quan = requestBody.Quantity.Quan.toString();
        }

        oModel.create("/NewPackingEntCollection", requestBody, {
          success: function success(successData, response) {
            //Check this function calls 
            element.setEnabled(true);
            BusyIndicator.hide();
            var cbFunction = successData.Cursor == "RFSCAN" ? _this7.setFocusOnScanInput : _this7.setFocusOnHUTypeInput;

            _this7.handleMessageResponse(response, cbFunction.bind(context));

            setTimeout(function () {
              _this7.onRowSelectionChangeUiTable(null, selectedIndex, true);
            }, 0);
            cbFunction.call(_this7);
          },
          error: function error(err) {
            element.setEnabled(true);
            BusyIndicator.hide();

            _this7.handleMessageResponse(err, _this7.setFocusOnHUTypeInput.bind(_this7));
          }
        });
      } else {
        element.setEnabled(true);
        BusyIndicator.hide();
        sap.m.MessageToast.show("No item is selected.");
      }
    },
    onOpenWeightDialog: function onOpenWeightDialog() {
      var view = this.getView();
      var popupDialogWeight = this.byId("popupDialogWeight");

      if (!popupDialogWeight) {
        Fragment.load({
          id: view.getId(),
          name: "y20_deco_inb_r.view.PopupDialogWeight",
          controller: this
        }).then(function (popupDialogWeight) {
          view.addDependent(popupDialogWeight);
          popupDialogWeight.open();
        });
      } else {
        this.byId("popupDialogWeight").open();
      }
    },
    onCloseWeightDialog: function onCloseWeightDialog() {
      var popupDialog = this.byId("popupDialogWeight");
      popupDialog.close();
    },
    onConfirmWeightDialog: function onConfirmWeightDialog() {
      var _this8 = this;

      var selectedIndex = this.currentSelectedTableItemFromFirstSection;

      if (selectedIndex !== undefined) {
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", {
          useBatch: false,
          defaultUpdateMethod: sap.ui.model.odata.UpdateMethod.Put
        });
        var dataArr = this.getView().getModel("modelDocItemNav").getData().results;
        var docId = dataArr[selectedIndex].DocId;
        var lgNum = dataArr[selectedIndex].Lgnum;
        var itemId = dataArr[selectedIndex].ItemId;
        var measureModelData = this.getView().getModel("measureModel").getData();
        measureModelData.Lgnum = lgNum;
        measureModelData.DocId = docId;
        measureModelData.ItemId = itemId;
        var setInfo = "(Lgnum='".concat(lgNum, "',DocId=guid'").concat(docId, "',ItemId=guid'").concat(itemId, "')");

        if (measureModelData.Weight.Quan && measureModelData.Height.Quan && measureModelData.Width.Quan && measureModelData.Length.Quan && measureModelData.Height.Unit) {
          oModel.update("/PopupWeightCollection" + setInfo, measureModelData, {
            success: function success(successData, response) {
              _this8.handleMessageResponse(response);

              sap.m.MessageToast.show("Confirmed!");
            },
            error: function error(err) {
              return _this8.handleMessageResponse(err);
            }
          });
          var popupDialog = this.byId("popupDialogWeight");
          popupDialog.close();
        } else {
          sap.m.MessageToast.show("Fill all input fields first!");
        }
      } else {
        sap.m.MessageToast.show("No item is selected.");
      }
    },
    onGoToAssignPressed: function onGoToAssignPressed() {
      var url = window.location.protocol + "//" + window.location.host;
      window.location.href = url + "/sap/bc/ui5_ui5/sap/y20_deashutron2/index.html";
    },
    setCurrentLoggedInUser: function setCurrentLoggedInUser() {
      var _this9 = this;

      var xmlHttp = new XMLHttpRequest();

      xmlHttp.onreadystatechange = function () {
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
          var oUserData = JSON.parse(xmlHttp.responseText);

          var user = " " + oUserData.id;
          _this9.byId("headerContentText").setText(_this9.byId("headerContentText").getText().concat(user));
        }
      };

      xmlHttp.open("GET", "/sap/bc/ui2/start_up", false);
      xmlHttp.send(null);
    },
    
    onUndoPressed: function onUndoPressed(oEvent) {
      var _this10 = this;

      var element = oEvent.getSource();
      element.setEnabled(false);
      BusyIndicator.show();
      var selectedIndex = this.currentSelectedTableItemFromFirstSection;

      if (selectedIndex !== undefined) {
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", {
          useBatch: false
        });
        var dataArr = this.getView().getModel("modelcreatedHUNav").getData().results;
        var selectedItemsArr = [];
        var selectedIndicesArr = this.byId("uiTableThird").getSelectedIndices();

        if (selectedIndicesArr.length > 0) {
          var docId = dataArr[0].DocId;
          var lgNum = dataArr[0].Lgnum;
          var itemId = dataArr[0].ItemId;
          selectedIndicesArr.forEach(function (index) {
            selectedItemsArr.push(dataArr[index]);
          });
          var requestBody = {
            "Lgnum": lgNum,
            "DocId": docId,
            "ItemId": itemId,
            "UserComm": ""
          };
          requestBody.UserComm_CreatedHUNav = selectedItemsArr;
          oModel.create("/UserCommandCollection", requestBody, {
            success: function success(successData, response) {
              element.setEnabled(true);
              BusyIndicator.hide();

              _this10.handleMessageResponse(response);

              sap.m.MessageToast.show("Undo Sucessfull!"); //update table 3

              var newModeldataResultsArr = successData.UserComm_CreatedHUNav;
              var jsonModelCreatedHUNav = new JSONModel(newModeldataResultsArr);

              _this10.getView().setModel(jsonModelCreatedHUNav, "modelcreatedHUNav");

              _this10.refreshModels();

              _this10.onRowSelectionChangeUiTable(null, selectedIndex);

              _this10.byId("uiTableThird").setSelectedIndex(-1);
            },
            error: function error(err) {
              element.setEnabled(true);
              BusyIndicator.hide();

              _this10.handleMessageResponse(err);
            }
          });
        } else {
          element.setEnabled(true);
          BusyIndicator.hide();
          sap.m.MessageToast.show("No items to undo are selected.");
        }
      } else {
        element.setEnabled(true);
        BusyIndicator.hide();
        sap.m.MessageToast.show("No item is selected.");
      }
    },
    onInfoPressed: function onInfoPressed(event, checkForMessages) {
      var _this11 = this;

      var selectedIndex = this.currentSelectedTableItemFromFirstSection;

      if (selectedIndex !== undefined) {
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
        var dataArr = this.getView().getModel("modelDocItemNav").getData().results;
        var docId = dataArr[selectedIndex].DocId;
        var lgNum = dataArr[selectedIndex].Lgnum;
        var itemId = dataArr[selectedIndex].ItemId;
        var setInfo = "(Lgnum='".concat(lgNum, "',DocId=guid'").concat(docId, "',ItemId=guid'").concat(itemId, "')");
        oModel.read("/UserCommandCollection" + setInfo, {
          useBatch: true,
          urlParameters: {
            "$expand": "UserComm_PopupInfoNav,UserComm_ItemTextNav"
          },
          success: function success(successData, response) {
            _this11.handleMessageResponse(response);

            var itemTexts = "";
            successData.UserComm_ItemTextNav.results.forEach(function (item) {
              itemTexts += item.Text + "\n";
            });
            var popupInfoNav = successData.UserComm_PopupInfoNav;
            popupInfoNav.ItemTXT = itemTexts;
            var jsonModelPopupInfoNav = new JSONModel(popupInfoNav);

            _this11.getView().setModel(jsonModelPopupInfoNav, "modelPopupInfoNav");

            _this11.refreshModels();

            if (checkForMessages) {
              if (popupInfoNav.ItemTXT && _this11.isPopupInfoShownArray[_this11.currentSelectedTableItemFromFirstSection]) {
                _this11.isPopupInfoShownArray[_this11.currentSelectedTableItemFromFirstSection] = false;

                _this11.onOpenInfoDialog();
              } else {
                var productNav = _this11.getView().getModel("modelProductNav").getData();

                if (productNav.IndConf && _this11.isPopupShownArray[_this11.currentSelectedTableItemFromFirstSection]) {
                  _this11.isPopupShownArray[_this11.currentSelectedTableItemFromFirstSection] = false;

                  _this11.onOpenWeightDialog();
                }
              }
            } else {
              _this11.onOpenInfoDialog();
            }
          },
          error: function error(err) {
            return _this11.handleMessageResponse(err);
          }
        });
      } else {
        sap.m.MessageToast.show("No item is selected.");
      }
    },
    onPrintSuccess: function onPrintSuccess(lastSelectedIndex) {
      var _this12 = this;

      //create request here
      if (lastSelectedIndex !== undefined) {
        var dataArr = this.getView().getModel("modelDocItemNav").getData().results;
        var docId = dataArr[lastSelectedIndex].DocId;
        var lgNum = dataArr[lastSelectedIndex].Lgnum;
        var itemId = dataArr[lastSelectedIndex].ItemId;
        var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/sap/Y20_EWM_DECO_INBOUND_RECEIVING_SRV", true);
        var setInfo = "(Lgnum = '".concat(lgNum, "', DocId = guid'").concat(docId, "', ItemId = guid'").concat(itemId, "')");
        BusyIndicator.show();
        oModel.read("/DocumentItemSet" + setInfo, {
          useBatch: true,
          urlParameters: {
            "$expand": "DocItem_CreatedHUNav"
          },
          success: function success(data, resp) {
            BusyIndicator.hide();
            var createdHUNav = data.DocItem_CreatedHUNav;
            var jsonModelCreatedHUNav = new JSONModel(createdHUNav);

            _this12.getView().setModel(jsonModelCreatedHUNav, "modelcreatedHUNav");

            _this12.refreshModels();

            sap.m.MessageToast.show("Data Updated!");

            _this12.handleMessageResponse(resp);
          },
          error: function error(err) {
            BusyIndicator.hide();

            _this12.handleMessageResponse(err);
          }
        });
      }
    },
    onOpenInfoDialog: function onOpenInfoDialog() {
      var view = this.getView();
      var popupDialogInfo = this.byId("popupDialogInfo");

      if (!popupDialogInfo) {
        Fragment.load({
          id: view.getId(),
          name: "y20_deco_inb_r.view.PopupDialogInfo",
          controller: this
        }).then(function (popupDialogInfo) {
          view.addDependent(popupDialogInfo);
          popupDialogInfo.open();
        });
      } else {
        this.byId("popupDialogInfo").open();
      }
    },
    onCloseInfoDialog: function onCloseInfoDialog() {
      var popupDialog = this.byId("popupDialogInfo");
      popupDialog.close();
      var productNav = this.getView().getModel("modelProductNav").getData();

      if (productNav.IndConf && this.isPopupShownArray[this.currentSelectedTableItemFromFirstSection]) {
        this.isPopupShownArray[this.currentSelectedTableItemFromFirstSection] = false;
        this.onOpenWeightDialog();
      }
    },
    handleUserInput: function handleUserInput(oEvent) {
      var userInput = oEvent.getParameter("value");
      var inputControl = oEvent.getSource();

      if (userInput) {
        inputControl.setValueState(sap.ui.core.ValueState.Success);
      } else {
        inputControl.setValueState(sap.ui.core.ValueState.Error);
      }
    },
    setFocusOnHUTypeInput: function setFocusOnHUTypeInput() {
      var input = this.getView().byId("scanPackHUType");
      setTimeout(function () {
        input.focus();
      }, 0);
    },
    setFocusOnScanInput: function setFocusOnScanInput() {
      var input = this.getView().byId("scanInput");
      setTimeout(function () {
        input.focus();
      }, 0);
    }
  });
});